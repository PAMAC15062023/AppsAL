<%@ Page Language="C#" MasterPageFile="~/BD/BD/BDMasterPage.master" AutoEventWireup="true" CodeFile="PresaleContractEntry.aspx.cs" Inherits="PresaleContractEntry" Theme="SkinFile" %>
<asp:Content ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div>
    <fieldset><legend class="legend">Presale Contract Entry</legend>
    <table width="100%" border="0" cellpadding="1" cellspacing="1">    
    <tr><td>
        <table width="100%" border="0" cellpadding="2" cellspacing="2">
            <tr>
                <td colspan="6">
                    <asp:Label ID="lblMsg" runat="server" SkinID="lblErrorMsg"></asp:Label></td>
            </tr>
            <tr><td colspan="6" class="tr1">Client Details</td></tr>
            <tr>
                <td valign="top" style="width: 15%">Presale Case Ref No<span style="color:Red;">*</span>
                </td>                
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtRefNo" runat="server" CssClass="textbox" MaxLength="50" ReadOnly="false" SkinID="txtSkin"></asp:TextBox>
                     <asp:ImageButton ID="imgGet" runat="server" AlternateText="Get Unique ID" ImageUrl="~/Images/find.gif"
                        OnClick="imgGet_Click" ToolTip="Get Unique ID" /></td>
                <td valign="top" style="width: 17%">Client<span style="color:Red;">*</span>
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:DropDownList ID="ddlClient" runat="server" OnSelectedIndexChanged="ddlClient_SelectedIndexChanged" AutoPostBack="True" CssClass="textbox" DataSourceID="sdsClient" DataTextField="CLIENT_NAME" DataValueField="CLIENT_ID" OnDataBound="ddlClient_DataBound" SkinID="ddlSkin">                                            
                    </asp:DropDownList>
                </td>
            </tr>
            <tr><td colspan="6" class="tr1">Visit Details</td></tr>
            <tr>
                <td valign="top">Domain
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtDomain" runat="server" ReadOnly="false" CssClass="textbox" SkinID="txtSkin"></asp:TextBox>                    
                </td>
                <td valign="top">Address
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtAddress" runat="server" TextMode="MultiLine" Columns="20" Rows="3" CssClass="textbox" MaxLength="300" SkinID="txtSkin"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td valign="top">Contact Person<span style="color:Red;">*</span>
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtConPerson" runat="server" CssClass="textbox" MaxLength="100" SkinID="txtSkin"></asp:TextBox>
                </td>
                <td valign="top">Designation
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtDesignation" runat="server" CssClass="textbox" MaxLength="100" SkinID="txtSkin"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td valign="top">Contact Email
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtConEmail" runat="server" CssClass="textbox" MaxLength="200" SkinID="txtSkin"></asp:TextBox>
                </td>
                <td valign="top">Contact Telephone<span style="color:Red;">*</span>
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtConTel" runat="server" CssClass="textbox" MaxLength="100" SkinID="txtSkin"></asp:TextBox>
                </td>
            </tr>
            <tr>
                <td valign="top">Lead Generated By<span style="color:Red;">*</span>
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:DropDownList ID="ddlLeadBy" runat="server" CssClass="textbox" DataSourceID="sdsLeadBy" DataTextField="FULLNAME" DataValueField="EMP_ID" OnDataBound="ddlLeadBy_DataBound" SkinID="ddlSkin">
                    </asp:DropDownList>
                </td>
                <td valign="top">Lead Generation Date<span style="color:Red;">*</span>
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtLeadDate" runat="server" CssClass="textbox" MaxLength="10" SkinID="txtSkin"></asp:TextBox> 
                    <img src="../../Images/SmallCalendar.gif" alt="Calendar" onclick="popUpCalendar(this, document.all.<%=txtLeadDate.ClientID%>, 'dd/mm/yyyy', 0, 0);" />
                </td>
            </tr>
            <tr><td colspan="6" class="tr1">BD Details</td></tr>
            <tr>
                <td valign="top">BD Manager<span style="color:Red;">*</span>
                </td>
                <td colspan="1" valign="top">
                    :</td>
                <td valign="top" colspan="4">
                    <asp:DropDownList ID="ddlBDManager" runat="server" CssClass="textbox" DataSourceID="sdsBDManager" DataTextField="FULLNAME" DataValueField="EMP_ID" OnDataBound="ddlBDManager_DataBound" SkinID="ddlSkin">                       
                    </asp:DropDownList>&nbsp;
                </td>
            </tr>
            <tr>
                <td colspan="3" valign="top">                  
                    <asp:GridView ID="gvActProd" runat="server" AutoGenerateColumns="False" DataSourceID="sdsActPro" SkinID="gridviewNoSort">
                        <Columns>      
                            <asp:TemplateField>
                                <ItemTemplate>
                                <asp:CheckBox ID="chkNo" runat="server" ></asp:CheckBox>                              
                                </ItemTemplate>
                                <ItemStyle HorizontalAlign="Left" />
                            </asp:TemplateField>                                              
                            <asp:TemplateField HeaderText="Activity" SortExpression="activity_name">                               
                                <ItemTemplate>
                                    <asp:Label ID="Label1" runat="server" Text='<%# Bind("activity_name") %>'></asp:Label>
                                    <asp:HiddenField ID="hdnActivityID" runat="server" Value='<%# Bind("activity_id") %>'></asp:HiddenField>
                                </ItemTemplate>
                            </asp:TemplateField>                           
                            <asp:TemplateField HeaderText="Product" SortExpression="product_name">                               
                                <ItemTemplate>
                                    <asp:Label ID="Label2" runat="server" Text='<%# Bind("product_name") %>'></asp:Label>
                                    <asp:HiddenField ID="hdnProductID" runat="server" Value='<%# Bind("product_id") %>'></asp:HiddenField>
                                </ItemTemplate>
                            </asp:TemplateField>
                        </Columns>
                    </asp:GridView>
                </td>
                <td valign="top">Remark
                </td>
                <td valign="top">
                    :</td>
                <td valign="top">
                    <asp:TextBox ID="txtRemark" runat="server" TextMode="MultiLine" Columns="30" Rows="5" CssClass="textbox" MaxLength="500" SkinID="txtSkin" ></asp:TextBox>
                </td>
            </tr> 
            <tr>
                <td align="left" colspan="6">
                    &nbsp;</td>
            </tr>
            <tr>
                <td align="center" colspan="6">
                    <asp:Button ID="btnSubmit" runat="server" Text="Submit" OnClick="btnSubmit_Click" ValidationGroup="grpPresaleContractEntry" SkinID="btnSubmitSkin" />&nbsp;
                    <asp:Button ID="btnCancel" runat="server" Text="Cancel" OnClick="btnCancel_Click" SkinID="btnCancelSkin" />
                </td>
            </tr>
        </table>
    </td></tr></table></fieldset>
    </div>
    <asp:RequiredFieldValidator ID="rfvID" runat="server" ControlToValidate="txtRefNo"
        Display="None" ErrorMessage="Please get Unique Presale Case Ref No" SetFocusOnError="True"
        ValidationGroup="grpPresaleContractEntry"></asp:RequiredFieldValidator>
        <asp:RequiredFieldValidator ID="rfvConPerson" runat="server" ControlToValidate="txtConPerson"
            Display="None" ErrorMessage="Please enter Contact Person" ValidationGroup="grpPresaleContractEntry" SetFocusOnError="True"></asp:RequiredFieldValidator>
        <asp:RequiredFieldValidator ID="rfvConTel" runat="server" ControlToValidate="txtConTel"
            Display="None" ErrorMessage="Please enter Contact Telephone" ValidationGroup="grpPresaleContractEntry" SetFocusOnError="True"></asp:RequiredFieldValidator>
        <asp:RequiredFieldValidator ID="rfvLeadBy" runat="server" ControlToValidate="ddlLeadBy"
            Display="None" ErrorMessage="Please select Lead Generated By" ValidationGroup="grpPresaleContractEntry" SetFocusOnError="True"></asp:RequiredFieldValidator>
        <asp:RequiredFieldValidator ID="rfvLeadDate" runat="server" ControlToValidate="txtLeadDate"
            Display="None" ErrorMessage="Please enter Lead Generation Date" ValidationGroup="grpPresaleContractEntry" SetFocusOnError="True"></asp:RequiredFieldValidator>
        <asp:RegularExpressionValidator ID="revLeadDate" runat="server" ControlToValidate="txtLeadDate" Display="None" ErrorMessage="Please enter valid date format for Lead Generation Date"
            SetFocusOnError="True" ValidationExpression="(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[0-2])[- /.](19|20|21)\d\d"
            ValidationGroup="grpPresaleContractEntry"></asp:RegularExpressionValidator>
        <asp:RegularExpressionValidator ID="revTel" runat="server" ErrorMessage="Please enter only numbers with , separator for Contact Telephone"
            ValidationExpression="^[0-9 ,]*$" ControlToValidate="txtConTel" Display="None" SetFocusOnError="True" ValidationGroup="grpPresaleContractEntry"></asp:RegularExpressionValidator>
        <asp:RegularExpressionValidator ID="revEmail" runat="server" ControlToValidate="txtConEmail"
            Display="None" ErrorMessage="Please enter valid Contact Email" SetFocusOnError="True"
            ValidationExpression="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]"
            ValidationGroup="grpPresaleContractEntry"></asp:RegularExpressionValidator>
        <asp:ValidationSummary ID="ValidationSummary1" runat="server" ShowMessageBox="True"
            ShowSummary="False" ValidationGroup="grpPresaleContractEntry" />
        &nbsp;&nbsp;&nbsp;
    <asp:RequiredFieldValidator ID="rfvBDmanager" runat="server" ControlToValidate="ddlBDManager"
        Display="None" ErrorMessage="please select BDManager" ValidationGroup="grpPresaleContractEntry"></asp:RequiredFieldValidator>
    <asp:RequiredFieldValidator ID="rfvclient" runat="server" ControlToValidate="ddlClient"
        Display="None" ErrorMessage="please select client" ValidationGroup="grpPresaleContractEntry"></asp:RequiredFieldValidator>
        <asp:SqlDataSource ID="sdsLeadBy" runat="server" ConnectionString="<%$ ConnectionStrings:CMConnectionString %>"
            ProviderName="<%$ ConnectionStrings:CMConnectionString.ProviderName %>" SelectCommand="SELECT EMP_ID,FULLNAME FROM EMPLOYEE_MASTER A, USER_ROLE B WHERE A.EMP_ID=B.USER_ID AND B.ROLE_ID=19 ORDER BY A.FULLNAME">
        </asp:SqlDataSource>
        <asp:HiddenField ID="hdnMode" runat="server" />
        <asp:SqlDataSource ID="sdsActPro" runat="server" ConnectionString="<%$ ConnectionStrings:CMConnectionString %>" ProviderName="<%$ ConnectionStrings:CMConnectionString.ProviderName %>" SelectCommand="SELECT [activity_id], [activity_name], [product_id], [product_name] FROM [activity_product_vw]"></asp:SqlDataSource>
        <asp:SqlDataSource ID="sdsBDManager" runat="server" ConnectionString="<%$ ConnectionStrings:CMConnectionString %>"
            ProviderName="<%$ ConnectionStrings:CMConnectionString.ProviderName %>" SelectCommand="SELECT EMP_ID,FULLNAME FROM EMPLOYEE_MASTER A, USER_ROLE B WHERE A.EMP_ID=B.USER_ID AND B.ROLE_ID=19 ORDER BY A.FULLNAME">
        </asp:SqlDataSource>
        <asp:SqlDataSource ID="sdsClient" runat="server" ConnectionString="<%$ ConnectionStrings:CMConnectionString %>"
            ProviderName="<%$ ConnectionStrings:CMConnectionString.ProviderName %>" SelectCommand="spGetClient;1" SelectCommandType="StoredProcedure">
        </asp:SqlDataSource>
        <asp:HiddenField ID="hdnContID" runat="server" />
 
    </asp:Content>
